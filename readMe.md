LINE CHATBOTとGASを用いた家計簿アプリ（個人利用）

■利用方法
・「家計簿アプリ_利用方法.pdf」を参照。

■設定方法
・LINE CHATBOTの登録
    ※以下のサイトを参考にしてください。
        https://qiita.com/nkjm/items/38808bbc97d6927837cd#channel%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B

    1.以下のサイトにアクセスし、アカウント登録を行ってください。
        https://developers.line.biz/ja/

    2.チャンネルを作成してください。

    3.アクセストークンを発行し、メモしてください。　★1

    1. 「Webhook送信」を「利用する」に変更してください。

    5.「Webhook URL」に★6を設定してください。
        ※手順5のみ「GAS作成」の後に実施ください。


・Googleドライブへのファイル配置
    1.LINE CHATBOT用のフォルダを作成してください。

    2.手順1で作成したフォルダに以下のフォルダを作成してください。
        ・画像
        ・グラフ
        ・マニュアル
    
    3.手順2で作成した「画像」フォルダを開き、 URLの「folder/」以降の部分をメモしてください。　★2
    
    4.手順2で作成した「グラフ」フォルダを開き、 URLの「folder/」以降の部分をメモしてください。　★3

    5.ファイルを配置してください。
        ・LINE_CHATBOT_家計簿_テンプレート.xlsx
    
    6.手順5で配置したファイルを開き、 URLの「spreadsheets/d」以降の部分をメモしてください。　★4
        ※「/edit#gid=～」部分は不要です。
    
    7.手順2で作成した「マニュアル」フォルダに以下のファイルを配置してください。
        ・家計簿アプリ_利用方法.pdf
    
    8.手順7で配置したファイルのリンクを取得してください。
    
    9.手順8で取得したリンクの「file/d/」以降の部分をメモしてください。　★5
        ※「/view?usp=share_link」部分は不要です。


・GAS作成
    1.Googleドライブにて「新規」→「その他」→「Google App Script」の順にクリックしてください。
    
    2.デフォルトで記載されている内容を削除してください。
    
    3.以下のファイルをメモ帳などで開いてください。
        ・main.js

    4.以下の部分を★3の内容に変更してください。
        ・const SPREAD_SHEET_ID = "テンプレートシートのIDを記載";
            →「const SPREAD_SHEET_ID = ★4」に変更してください

    5.手順3で開いたファイルをすべてコピーしてください。
        ※手順4で編集した内容を含む

    6.手順1で作成したページに貼り付けてください。

    7.「ctrl + s」で保存してください。

    8.「デプロイ」→「新しいデプロイ」の順にクリックしてください。

    9.「種類の選択」→「ウェブアプリ」の順にクリックしてください。

    10.「アクセスできるユーザ」を「全員」に変更してください。

    11.「デプロイ」をクリックしてください。

    12.承認を求められた場合、「アクセスを承認」をクリックしてください。

    13.URLをメモします。　★6


・スプレッドシート内の設定値変更
    1.「Googleドライブへのファイル配置」.手順5で配置したスプレッドシートを開いてください。

    2.「予定」シートを開いてください。

    3.「B3:C22」に家計簿で登録したい項目と月の予定額を入力してください。

    4.「yyyyMM_実績」シートを開いてください。

    5.「H6:H20」に家計簿で登録したい項目と月の予定額を入力してください。

    4.「yyyyMM_実績」シートを非表示にしてください。

    7.「C27」に★1を入力してください。

    8.「C34」に★2を入力してください。

    9.「C35」に★3を入力してください。

    10.「C38」に★5を入力してください。



・LINE CHATBOTのメニュー登録
    ※以下のサイトを参考にしてください。
        https://qiita.com/bow_arrow/items/32ac5d2b4c67bd0c1dc2

    1.以下のサイトにアクセスし、「LINE CHATBOT登録」で作成したチャンネルをクリックしてください。
        https://manager.line.biz/account
        
    2.左のサイドバーから「リッチメニュー」をクリックします。

    3.「作成」ボタンをクリックします。

    4.「表示期間」を設定します。
        →ずっと利用する場合、「開始期間 + 10年」などの期間を入力すればOKです
    
    5.アクションに以下を設定してください。
        ・テキスト - 使い方
        ・テキスト - 支出項目
        ・テキスト - 画像なし
        ・テキスト - 支出明細
    
    6.画像を適当に登録してください。

    7.「保存」をクリックしてください。